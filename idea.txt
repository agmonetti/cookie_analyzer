# Cookie Analyzer - Documentaci√≥n T√©cnica

## üìã Descripci√≥n General

Cookie Analyzer es una extensi√≥n de navegador que analiza, clasifica y permite eliminar cookies seg√∫n su nivel de riesgo de seguridad y privacidad. Utiliza m√∫ltiples criterios de an√°lisis basados en mejores pr√°cticas de seguridad web y bases de datos de cookies conocidas.

## üîç Criterios de An√°lisis

### 1. **Cookies de Tracking y Analytics**
- **Detecta**: Cookies de Google Analytics, Facebook, Hotjar, Mixpanel, etc.
- **Base de datos**: Lista de nombres conocidos como `_ga`, `_gid`, `_fbp`, `_hjid`
- **Dominios**: Verifica si pertenecen a dominios de tracking conocidos
- **Puntuaci√≥n**: +35-40 puntos de riesgo

### 2. **Cookies de Fingerprinting**
- **Detecta**: Cookies que recopilan caracter√≠sticas del dispositivo
- **Patrones**: `canvas_fp`, `webgl_fp`, `device_id`, `browser_id`
- **Valores**: Hashes de caracter√≠sticas del hardware/software
- **Puntuaci√≥n**: +45 puntos de riesgo

### 3. **Cookies de Terceros (Cross-Site)**
- **Detecta**: Cookies de dominios diferentes al sitio actual
- **M√©todo**: Compara el dominio de la cookie con la URL actual
- **Riesgo**: Tracking entre sitios web
- **Puntuaci√≥n**: +25 puntos de riesgo

### 4. **Cookies de Autenticaci√≥n/Sesi√≥n**
- **Detecta**: Nombres/valores relacionados con autenticaci√≥n
- **Patrones cr√≠ticos**:
  - Nombres: `token`, `auth`, `session`, `jwt`, `csrf`, `secret`, `key`, `api`, `bearer`, `sid`, `login`
  - Valores: Tokens JWT, hashes hexadecimales largos, cadenas base64
- **Puntuaci√≥n**: +30-40 puntos de riesgo

### 5. **Configuraci√≥n de Seguridad**
- **HttpOnly**: Protege contra ataques XSS
  - Cookie sensible sin HttpOnly: +25 puntos
  - Cookie normal sin HttpOnly: +5 puntos
- **Secure**: Protege la transmisi√≥n en HTTPS
  - Cookie sensible sin Secure: +20 puntos
  - Cookie normal sin Secure: +5 puntos
- **SameSite**: Protege contra ataques CSRF
  - Cookie sensible sin SameSite: +20 puntos
  - Cookie normal sin SameSite: +5 puntos

### 6. **An√°lisis de Entrop√≠a**
- **Detecta**: Valores con alta aleatoriedad (posiblemente cifrados)
- **M√©todo**: Calcula la entrop√≠a de Shannon del valor
- **Umbral**: Entrop√≠a > 4 indica valor aleatorio/cifrado
- **Puntuaci√≥n**: +20 puntos de riesgo

### 7. **Caracter√≠sticas Sospechosas**
- **Valores largos**: M√°s de 100 caracteres (+15 puntos)
- **Tokens JWT**: Formato `xxx.yyy.zzz` (+40 puntos)
- **Hashes hexadecimales**: 32+ caracteres hex (+25 puntos)
- **Cadenas base64**: 40+ caracteres base64 (+25 puntos)

### 8. **Patrones Maliciosos**
- **Detecta**: Nombres/valores con t√©rminos maliciosos
- **Patrones**: `malware`, `virus`, `exploit`, `xss`, `injection`, `backdoor`
- **Puntuaci√≥n**: +80 puntos de riesgo

## üìä Sistema de Puntuaci√≥n

### Niveles de Riesgo:
- **0-29 puntos**: üü¢ **Segura** (Verde)
- **30-49 puntos**: üîµ **Media** (Azul)
- **50-69 puntos**: üü° **Alta** (Amarillo)
- **70-100 puntos**: üî¥ **Cr√≠tica** (Rojo)


## üõ°Ô∏è Bases de Datos Incluidas

### Cookies Maliciosas Conocidas:
```javascript
'_ga', '_gid', '_gat', '_gtag', '_fbp', '_fbc', 'fr', 'doubleclick',
'_hjid', '_hjFirstSeen', '_hjIncludedInSessionSample', 'hotjar',
'amplitude', 'mixpanel', 'segment', 'intercom', 'drift',
'__utma', '__utmb', '__utmc', '__utmz', '__utmt',
'yandex_metrica', 'ya_metrica', '_ym_', '_yasc',
'optimizely', 'vwo_uuid', 'ab_test', 'split_test'
```

### Dominios de Tracking:
```javascript
'google-analytics.com', 'googletagmanager.com', 'doubleclick.net',
'facebook.com', 'connect.facebook.net', 'hotjar.com',
'mixpanel.com', 'segment.com', 'amplitude.com',
'yandex.ru', 'mc.yandex.ru', 'optimizely.com'
```

## üîß Funcionalidades

### 1. **An√°lisis Autom√°tico**
- Carga autom√°tica al abrir la extensi√≥n
- An√°lisis en tiempo real de todas las cookies del sitio
- Ordenamiento por nivel de riesgo (mayor riesgo primero)

### 2. **Visualizaci√≥n**
- **Resumen estad√≠stico**: Contador por nivel de riesgo
- **Detalles por cookie**: Nombre, valor, dominio, configuraci√≥n de seguridad
- **Motivos de alerta**: Lista espec√≠fica de por qu√© es riesgosa
- **C√≥digo de colores**: Visual inmediato del nivel de riesgo

### 3. **Acciones de Eliminaci√≥n**
- **Eliminar cookie individual**: Bot√≥n por cada cookie riesgosa
- **Eliminar sospechosas**: Elimina todas las cookies con riesgo ‚â•30
- **Eliminar todas**: Elimina todas las cookies del sitio actual

### 4. **Informaci√≥n Detallada**
Para cada cookie muestra:
- **Nombre y valor** (truncado si es muy largo)
- **Dominio** de origen
- **Configuraci√≥n de seguridad**: Secure, HttpOnly, SameSite
- **Fecha de expiraci√≥n**
- **Porcentaje de riesgo**
- **Motivos espec√≠ficos** de la clasificaci√≥n

## üö® Casos de Uso

### Cookies que deber√≠an ser CR√çTICAS:
- `auth_token` sin HttpOnly/Secure
- `canvas_fp` con hash de fingerprinting
- `session_id` con configuraci√≥n insegura
- Tokens JWT accesibles desde JavaScript

### Cookies que deber√≠an ser ALTAS:
- `_ga` (Google Analytics)
- `_fbp` (Facebook Pixel)
- Cookies de terceros sin SameSite

### Cookies que deber√≠an ser SEGURAS:
- `preferencias=oscuro` con Secure + SameSite=strict
- `idioma=es` con configuraci√≥n adecuada
- Cookies funcionales bien configuradas

## ‚ö†Ô∏è Limitaciones

1. **An√°lisis heur√≠stico**: No es 100% infalible, puede tener falsos positivos/negativos
2. **Contexto limitado**: No conoce la funcionalidad espec√≠fica de cada cookie
3. **Sitios internos**: No funciona en p√°ginas `chrome://` o internas del navegador
4. **Cookies HttpOnly**: No puede ver cookies marcadas como HttpOnly (desde JavaScript)

## üîÑ Actualizaciones Futuras

- **Base de datos ampliada**: M√°s cookies de tracking conocidas
- **Machine Learning**: Detecci√≥n autom√°tica de patrones
- **Exportaci√≥n**: Guardar reportes de an√°lisis
- **Whitelist**: Permitir cookies espec√≠ficas como seguras
- **Integraci√≥n**: APIs de servicios de seguridad externos

## üìù Recomendaciones de Uso

1. **Complementar con otras herramientas**: Privacy Badger, uBlock Origin
2. **Revisar regularmente**: Las cookies cambian constantemente
3. **Verificar manualmente**: Especialmente en sitios cr√≠ticos (banca, etc.)
4. **Educaci√≥n**: Entender qu√© hace cada cookie antes de eliminarla
5. **Backup**: Algunas cookies son necesarias para el funcionamiento del sitio

---

**Versi√≥n**: 2.9  
**√öltima actualizaci√≥n**: Junio 2025  
**Desarrollado con**: Manifest V3, JavaScript, Chrome Extensions API